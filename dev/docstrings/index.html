<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Docstrings · GasChromatographySystems</title><meta name="title" content="Docstrings · GasChromatographySystems"/><meta property="og:title" content="Docstrings · GasChromatographySystems"/><meta property="twitter:title" content="Docstrings · GasChromatographySystems"/><meta name="description" content="Documentation for GasChromatographySystems."/><meta property="og:description" content="Documentation for GasChromatographySystems."/><meta property="twitter:description" content="Documentation for GasChromatographySystems."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GasChromatographySystems</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Instalation</a></li><li><a class="tocitem" href="../definition_sys/">Definition of a GC system</a></li><li><a class="tocitem" href="../flowcalc/">Flow calculation</a></li><li><a class="tocitem" href="../simulation/">Simulation</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li class="is-active"><a class="tocitem" href>Docstrings</a><ul class="internal"><li><a class="tocitem" href="#Module-Index"><span>Module Index</span></a></li><li><a class="tocitem" href="#Detailed-API"><span>Detailed API</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Docstrings</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Docstrings</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/main/docs/src/docstrings.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="Module-Index"><a class="docs-heading-anchor" href="#Module-Index">Module Index</a><a id="Module-Index-1"></a><a class="docs-heading-anchor-permalink" href="#Module-Index" title="Permalink"></a></h2><h2 id="Detailed-API"><a class="docs-heading-anchor" href="#Detailed-API">Detailed API</a><a id="Detailed-API-1"></a><a class="docs-heading-anchor-permalink" href="#Detailed-API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.ModuleColumn" href="#GasChromatographySystems.ModuleColumn"><code>GasChromatographySystems.ModuleColumn</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ModuleColumn(; Tcold_abs=true, sflank=40, tflank=20, alg=Vern9(), abstol=1e-10, reltol=1e-8, dtinit=1e-6, ng=true, Tcontrol=&quot;inlet&quot;)</code></pre><p>Structure describing the module of a gas chromatographic column, the basic buliding block of a gas chromatographic system. These are edges of the graph representation of a GC system. </p><p><strong>Arguments</strong></p><ul><li><code>name</code>: Name of the module.</li><li><code>L</code>: Length of the column in m.</li><li><code>d</code>: Internal diameter of the column in m. This can be a function of column position, if a non-uniform diameter is used (not tested yet).</li><li><code>a_d</code>: Parameters of the diameter function <code>d</code>. Empty, if <code>d</code> is not a function. </li><li><code>df</code>: Film thickness of the column in m. This can be a function of column position, if a non-uniform film thickness is used (not tested yet).</li><li><code>a_df</code>: Parameters of the film thickness function <code>df</code>. Empty, if <code>df</code> is not a function. </li><li><code>sp</code>: The name of the stationary phase.</li><li><code>T</code>: Temperature of the module. This can be a value (in °C) or a temperature program as a <code>TemperatureProgram</code> structure. </li><li><code>F</code>: Flow of the mobile phase through the column in mL/min. This can be an number, a fuction or a NaN (if it is not defined yet an should be calculated based on values from other modules or pressure points in the system).</li><li><code>opt</code>: Options for this module. This is a structure of the form <code>ModuleColumnOptions</code>.</li></ul><p>Four methods to construct this structure exist:</p><ul><li><code>ModuleColumn(name, L, d, df, sp, T, opt::ModuleColumnOptions)</code>: The flow is not defined, uniform <code>d</code> and <code>df</code>.</li><li><code>ModuleColumn(name, L, d, df, sp, T, F, opt::ModuleColumnOptions)</code>: The flow is defined by <code>F</code> and uniform <code>d</code> and <code>df</code>.</li><li><code>ModuleColumn(name, L, d, df, sp, T; alg=OwrenZen5(), abstol=1e-8, reltol=1e-6, ng=false, Tcontrol=&quot;inlet&quot;)</code>: The flow is not defined, uniform <code>d</code> and <code>df</code>. Options according to <code>ModuleColumnOptions</code>.</li><li><code>ModuleColumn(name, L, d, df, sp, tp, flow; alg=OwrenZen5(), abstol=1e-8, reltol=1e-6, ng=false, Tcontrol=&quot;inlet&quot;)</code>: The flow is defined by <code>F</code> and uniform <code>d</code> and <code>df</code>. Options according to <code>ModuleColumnOptions</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Structures.jl#L93-L115">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.ModuleColumnOptions" href="#GasChromatographySystems.ModuleColumnOptions"><code>GasChromatographySystems.ModuleColumnOptions</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ModuleColumnOptions(; alg=OwrenZen5(), abstol=1e-8, reltol=1e-5, ng=false, Tcontrol=&quot;inlet&quot;)</code></pre><p>Structure describing options for column modules. </p><p><strong>Arguments</strong></p><ul><li><code>alg</code>: The algorithm used for the ODE solver. The algorithms <code>OwrenZen3()</code>, <code>OwrenZen4()</code> and <code>OwrenZen5()</code> are recommended.</li><li><code>abstol</code>: The absolute tolerance for the ODE solver. Recommended value 1e-6 to 1e-8.</li><li><code>reltol</code>: The relative tolerance for the ODE solver. Recommended value 1e-3 to 1e-5. </li><li><code>ng</code>: Option to calculate the simulation without a gradient (<code>ng = true</code>, default) or with a gradient (<code>ng = false</code>).</li><li><code>Tcontrol</code>: Option defining at which point of the column the temperature program is calculated. The options are <code>inlet</code> (x=0) and <code>outlet</code> (x=L).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Structures.jl#L32-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.ModuleTM" href="#GasChromatographySystems.ModuleTM"><code>GasChromatographySystems.ModuleTM</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ModuleTM(; Tcold_abs=true, sflank=40, tflank=20, alg=Vern9(), abstol=1e-10, reltol=1e-8, dtinit=1e-6, ng=true, Tcontrol=&quot;inlet&quot;)</code></pre><p>Structure describing the module of a thermal modulator, a short section of a column with a periodic repeating temperature modulation between a cold and hot jet. These are edges of the graph representation of a GC system.</p><p><strong>Arguments</strong></p><ul><li><code>name</code>: Name of the module.</li><li><code>L</code>: Length of the column in m.</li><li><code>d</code>: Internal diameter of the column in m. This can be a function of column position, if a non-uniform diameter is used (not tested yet).</li><li><code>a_d</code>: Parameters of the diameter function <code>d</code>. Empty, if <code>d</code> is not a function. </li><li><code>df</code>: Film thickness of the column in m. This can be a function of column position, if a non-uniform film thickness is used (not tested yet).</li><li><code>a_df</code>: Parameters of the film thickness function <code>df</code>. Empty, if <code>df</code> is not a function. </li><li><code>sp</code>: The name of the stationary phase.</li><li><code>T</code>: Basic temperature of the module. On top of this temperature the modulation occurs. This can be a value (in °C) or a temperature program as a <code>TemperatureProgram</code> structure. </li><li><code>shift</code>: Time shift in s of the periodic modulation relative to the start of the chromatogram.</li><li><code>PM</code>: Modulation period in s.</li><li><code>ratio</code>: The ratio of the duration of cold and hot jet.</li><li><code>Thot</code>: Temperature in °C, by which <code>T</code> is increased while the hot jet is active. </li><li><code>Tcold</code>: Temperature in °C, by which <code>T</code> is decrease while the cold jet is active (if <code>Tcold_abs = false</code> in <code>ModuleColumnOptions</code>) or to which the column is cooled down (if <code>Tcold_abs = true</code> in <code>ModuleTMOptions</code>)</li><li><code>F</code>: Flow of the mobile phase through the column in mL/min. This can be an number, a fuction or a NaN (if it is not defined yet an should be calculated based on values from other modules or pressure points in the system).</li><li><code>opt</code>: Options for this module. This is a structure of the form <code>ModuleTMOptions</code>.</li></ul><p>Four methods to construct this structure exist:</p><ul><li><code>ModuleTM(name, L, d, df, sp, T, shift, PM, ratio, Thot, Tcold, opt::ModuleTMOptions)</code>: The flow is not defined, uniform <code>d</code> and <code>df</code>.</li><li><code>ModuleTM(name, L, d, df, sp, T, shift, PM, ratio, Thot, Tcold, F, opt::ModuleTMOptions)</code>: The flow is defined by <code>F</code> and uniform <code>d</code> and <code>df</code>.</li><li><code>ModuleTM(name, L, d, df, sp, T, shift, PM, ratio, Thot, Tcold; Tcold_abs=true, sflank=40, tflank=20, alg=Vern9(), abstol=1e-10, reltol=1e-8, dtinit=1e-6, ng=false, Tcontrol=&quot;inlet&quot;)</code>: The flow is not defined, uniform <code>d</code> and <code>df</code>. Options according to <code>ModuleTMOptions</code>.</li><li><code>ModuleTM(name, L, d, df, sp, tp, shift, pm, ratio, Thot, Tcold, F; Tcold_abs=true, sflank=40, tflank=20, alg=Vern9(), abstol=1e-10, reltol=1e-8, dtinit=1e-6, ng=false, Tcontrol=&quot;inlet&quot;)</code>: The flow is defined by <code>F</code> and uniform <code>d</code> and <code>df</code>. Options according to <code>ModuleTMOptions</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Structures.jl#L158-L185">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.ModuleTMOptions" href="#GasChromatographySystems.ModuleTMOptions"><code>GasChromatographySystems.ModuleTMOptions</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ModuleTMOptions(; Tcold_abs=true, sflank=40, tflank=20, alg=Vern9(), abstol=1e-10, reltol=1e-8, dtinit=1e-6, ng=true, Tcontrol=&quot;inlet&quot;)</code></pre><p>Structure describing options for thermal modulator modules. </p><p><strong>Arguments</strong></p><ul><li><code>Tcold_abs</code>: Calculate the low temperature at the modulator as the absolute value of the defined parameter <code>Tcold</code> (<code>Tcold_abs = true</code>) or as relative temperature difference from the defined oven temperature (<code>Tcold_abs = false</code>).</li><li><code>sflank</code>: Flank factor of the smoothed rectangle temperature function in space. A higher factor results in a steeper slope at the edges of the modulator point. Values between 12 and 100, or Inf if <code>ng = true</code>. Recommend <code>sflank = 40</code>. Only relevante, if option <code>ng = false</code>. </li><li><code>tflank</code>: Flank factor of the smoothed rectangle temperature function in time. A higher factor results in a steeper slope at the begining and end of the hot jet. Values between 12 and 100. Recommend <code>tflank = 20</code>.</li><li><code>alg</code>: The algorithm used for the ODE solver. For the thermal modulator module the algorithm <code>Vern9()</code> is recommend.</li><li><code>abstol</code>: The absolute tolerance for the ODE solver. Recommended value 1e-6 to 1e-12.</li><li><code>reltol</code>: The relative tolerance for the ODE solver. Recommended value 1e-3 to 1e-10.</li><li><code>dtinit</code>: The initial step width for the ODE solver. A value of <code>L*1e-6</code>, with <code>L</code> the length of the modulator module, is recommend. </li><li><code>ng</code>: Option to calculate the simulation without a gradient (<code>ng = true</code>, default) or with a gradient (<code>ng = false</code>).</li><li><code>Tcontrol</code>: Option defining at which point of the column the temperature program is calculated. The options are <code>inlet</code> (x=0) and <code>outlet</code> (x=L).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Structures.jl#L56-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.Options" href="#GasChromatographySystems.Options"><code>GasChromatographySystems.Options</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Options(; gas=&quot;He&quot;, odesys=true, vis=&quot;Blumberg&quot;, control=&quot;Pressure&quot;, k_th=1e12)</code></pre><p>Structure describing general options for the simulation of the system. </p><p><strong>Arguments</strong></p><ul><li><code>gas</code>: The type of gas used as mobile phase in the gas chromatographic system. Allowed values: He, H2 or N2.</li><li><code>odesys</code>: Combine the ODEs for migration and peak-width into a system of ODEs (<code>odesys = true</code>) or solve the two ODEs separately (<code>odesys = false</code>).</li><li><code>vis</code>: Used model of viscosity. <code>HP</code> is a second-order polynomial taken from the HP flow calculator. <code>Blumberg</code> is an emperical formula according to the book   <code>Temperature-programmed Gas Chromatography</code> by Leonid M. Blumberg (2010, Wiley-VCH).</li><li><code>control</code>: Control of the &quot;Flow&quot; or of the &quot;Pressure&quot; (at column inlet) during the program.</li><li><code>k_th</code>: Threshold for the maximum of the retention factor. If the calculated retention factor is bigger than <code>k_th</code> than the retention factor is set to the value <code>k_th</code>.   This is done to avoid to small step widths in the solver for highly retained soultes at the beginning of a GC program. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Structures.jl#L4-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.PressurePoint" href="#GasChromatographySystems.PressurePoint"><code>GasChromatographySystems.PressurePoint</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PressurePoint(name, PP)</code></pre><p>Structure describing the pressure program at the connection points of the modules. These are the vertices of the graph representation of a GC system.</p><p><strong>Arguments</strong></p><ul><li><code>name</code>: Name of the <code>PressurePoint</code>.</li><li><code>P</code>: Pressure program as structure <code>GasChromatographySystems.PressureProgram</code> or as a number for constant pressure.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Structures.jl#L297-L305">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.PressureProgram" href="#GasChromatographySystems.PressureProgram"><code>GasChromatographySystems.PressureProgram</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PressureProgram(time_steps, pressure_steps)</code></pre><p>Structure describing the pressure program. </p><p><strong>Arguments</strong></p><ul><li><code>time_steps</code>: Time steps in s, after which the corresponding pressure in <code>pressure_steps</code> is reached. </li><li><code>pressure_steps</code>: Pressure steps in Pa.</li></ul><p>A default temperature program is avaliable:</p><ul><li><code>default_PP()</code>: Pressure increase from 100.000 Pa to 200.000 in 1800 s (30 min). </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Structures.jl#L276-L287">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.System" href="#GasChromatographySystems.System"><code>GasChromatographySystems.System</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">System(g, pressurepoints, modules, options)</code></pre><p>Structure describing a GC system. </p><p><strong>Arguments</strong></p><ul><li><code>name</code>: Name of the GC system.</li><li><code>g</code>: The graph representation of the GC system, using <code>SimpleDiGraph</code> from <code>Graphs.jl</code>. </li><li><code>pressurepoints</code>: The vertices of graph <code>g</code> and their pressure programs. These are structures of type <code>PressurePoint</code>. </li><li><code>modules</code>: The edges of graph <code>g</code>. These are column segments of type <code>ModuleColumn</code> or thermal modulator points of type <code>ModuleTM</code>.</li></ul><p><strong>Examples</strong></p><p><strong>Simple GC:</strong></p><p>Definition of the graph:</p><pre><code class="language-julia hljs">    g = SimpleDiGraph(1)
    add_edge!(g, 1, 2)</code></pre><p>Definition of the two pressure points, here column inlet has the default pressure program and the outlet pressure is constant:</p><pre><code class="language-julia hljs">    pp = Array{GasChromatographySystems.PressurePoint}(undef, nv(g))
    pp[1] = GasChromatographySystems.PressurePoint(&quot;p_in&quot;, GasChromatographySystems.default_PP())
    pp[2] = GasChromatographySystems.PressurePoint(&quot;p_out&quot;, pout)</code></pre><p>Definition of the column module with default temperature program <code>default_TP()</code>, flow is unknown and is calculated from the pressures, default module options:</p><pre><code class="language-julia hljs">    modules = Array{GasChromatographySystems.AbstractModule}(undef, ne(g))  
    modules[1] = GasChromatographySystems.ModuleColumn(&quot;column&quot;, 30.0, 0.25*1e-3, 0.25*1e-6, &quot;Rxi5ms&quot;, GasChromatographySystems.default_TP())</code></pre><p>Combination to construct the System using the function <code>update_system()</code> and default system options:</p><pre><code class="language-julia hljs">    sys = GasChromatographySystems.update_system(GasChromatographySystems.System(g, pp, modules, GasChromatographySystems.Options()))</code></pre><p><strong>Series of <code>n</code> columns:</strong></p><p>Definition of the graph:</p><pre><code class="language-julia hljs">    g = SimpleDiGraph(n+1)
	for i=1:n
		add_edge!(g, i, i+1) 
	end</code></pre><p><strong>Split of Columns:</strong></p><p><strong>GCxGC with thermal modulation and loop:</strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Structures.jl#L313-L365">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.TemperatureProgram" href="#GasChromatographySystems.TemperatureProgram"><code>GasChromatographySystems.TemperatureProgram</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TemperatureProgram(time_steps, temp_steps, gf, a_gf)</code></pre><p>Structure describing the temperature program. </p><p><strong>Arguments</strong></p><ul><li><code>time_steps</code>: Time steps in s, after which the corresponding temperature in <code>temp_steps</code> is reached. </li><li><code>temp_steps</code>: Temperature steps in °C.</li><li><code>gf</code>: Gradient function <code>gf(x, a_gf)</code>, describes the thermal gradient.</li><li><code>a_gf</code>:Parameters of the gradient function.</li></ul><p>Two method to construct this structure exist for a uniform temperatur program (same for all column positions <code>x</code>):</p><ul><li><code>TemperatureProgram(time_steps, temp_steps)</code></li><li><code>TemperatureProgram(CP)</code>, with <code>CP</code> beeing a conventional notation of a temperature program in the form of an array with the pattern <code>[T1, t1, r1, T2, t2, r2, ..., Tn, tn]</code>, with <code>Ti</code> temperature niveaus, <code>ti</code> holding times for the corresponding tempertures, <code>ri</code> the heating ramp between temperatures <code>Ti</code> and <code>Ti+1</code>.</li></ul><p>A default temperature program is avaliable:</p><ul><li><code>default_TP()</code>: Heating from 40°C to 340°C in 1800 s (30 min). </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Structures.jl#L231-L248">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.build_pressure_squared_functions-Tuple{Any, Any}" href="#GasChromatographySystems.build_pressure_squared_functions-Tuple{Any, Any}"><code>GasChromatographySystems.build_pressure_squared_functions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_pressure_squared_functions(sys, solutions; mode=&quot;λ&quot;)</code></pre><p>Construct array of functions of the solutions for the unkown squared pressures of the flow balance equations of the system of capillaries <code>sys</code>.</p><p>The arguments for the build functions are arrays of the ordered known squared pressures <span>$p^2$</span>, the ordered known flow permabilities <span>$λ$</span> resp. flow restrictions <span>$κ$</span>, the ordered known flows <span>$F$</span> and constant <span>$A = π/256 p_n/T_n$</span>.  </p><p><strong>Arguments</strong></p><ul><li><code>sys</code>: System structure of the capillary system for which the flow balance is set up.</li><li><code>solutions</code>: The solutions of the flow balance equations for the unknown pressures as symbolic expressions.</li><li><code>mode</code>: Mode for flow equations to use flow permeabilities λ (<code>mode = λ</code>; default) or flow restrictions κ (<code>mode = κ</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Flowcalc.jl#L321-L332">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.check_expressions_λ_κ-Tuple{Any}" href="#GasChromatographySystems.check_expressions_λ_κ-Tuple{Any}"><code>GasChromatographySystems.check_expressions_λ_κ</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_expressions_λ_κ(sol; mode=&quot;λ&quot;, n=100)</code></pre><p>Checks the expressions of the array <code>sol</code> (solutions to the flow balance equations) if they use the flow permeabilities λ or the flow restrictions κ and substitutes them if needed. </p><p><strong>Arguments</strong></p><ul><li><code>sol</code>: Symbolic expressions (of the solutions for the flow balance equations) </li><li><code>mode</code>: Mode for flow equations to use flow permeabilities λ (<code>mode = λ</code>; default) or flow restrictions κ (<code>mode = κ</code>)</li><li><code>n</code>: Maximum of the number of expected symbols λ resp. κ. Could be replaced by the number of edges of the used system <code>n = ne(sys.g)</code>. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Flowcalc.jl#L392-L401">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.check_retention_cold_jet-NTuple{8, Any}" href="#GasChromatographySystems.check_retention_cold_jet-NTuple{8, Any}"><code>GasChromatographySystems.check_retention_cold_jet</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_retention_cold_jet(T, par, df_A, PM, ratio, shift, Thot, Tcold)</code></pre><p>Check if solutes are retained during the cold phase of thermal modulation by calculating their migration distance.</p><p>This function analyzes whether solutes will be retained in the column during the cold phase of thermal modulation by calculating their migration distance under cold phase conditions. It determines if solutes will reach the end of the column before the cold phase ends.</p><p><strong>Arguments</strong></p><ul><li><code>T</code>: Base temperature or temperature program for the column</li><li><code>par</code>: Parameters structure containing column, program, and substance information</li><li><code>df_A</code>: DataFrame containing peak areas and initial times from slicing</li><li><code>PM</code>: Modulation period in seconds</li><li><code>ratio</code>: Ratio of cold phase duration to total period (0 &lt; ratio &lt; 1)</li><li><code>shift</code>: Time shift of the modulation pattern in seconds</li><li><code>Thot</code>: Temperature difference for hot phase in °C</li><li><code>Tcold</code>: Temperature difference for cold phase in °C (absolute or relative)</li></ul><p><strong>Returns</strong></p><ul><li>DataFrame containing:<ul><li>Name: Substance names</li><li>retained: Boolean array indicating if solutes are retained during cold phase</li><li>x_cold: Calculated migration distance during cold phase</li><li>k_cold: Retention factors during cold phase</li><li>t<em>start</em>cold: Start times of cold phases</li><li>tstart: Initial start times of peaks</li></ul></li></ul><p><strong>Notes</strong></p><ul><li>Uses mod_number for consistent modulation period calculations</li><li>Calculates migration distance based on cold phase duration and retention factors</li><li>Considers both absolute and relative cold phase temperatures</li><li>A solute is considered retained if its migration distance is less than column length</li><li>Useful for predicting breakthrough during cold phase of modulation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/ThermalModulator.jl#L445-L479">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.flow_balance-Tuple{Any}" href="#GasChromatographySystems.flow_balance-Tuple{Any}"><code>GasChromatographySystems.flow_balance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">flow_balance(sys)</code></pre><p>Constructing the flow balance equations of the capillary system <code>sys</code> in the form of an array of symbolic equations.</p><p>For every inner vertice the sum of ingoing flows (positive) and of outgoing flows (negative) are equated to zero.</p><p class="math-container">\[\Sum  F_{in} + \Sum F_{out} = 0\]</p><p><strong>Arguments</strong></p><ul><li><code>sys</code>: System structure of the capillary system for which the flow balance is set up.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Flowcalc.jl#L5-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.flow_functions-Tuple{Any, Any}" href="#GasChromatographySystems.flow_functions-Tuple{Any, Any}"><code>GasChromatographySystems.flow_functions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">flow_functions(sys, p2fun; mode=&quot;λ&quot;)</code></pre><p>Collects the flow functions as functions of time t for all edges of the system of capillaries <code>sys</code>.</p><p>The flow over edge <code>i =&gt; j</code> is calculated as</p><p class="math-container">\[F_{i,j} = \frac{A}{κ_{i,j}} \left(p_i^2-p_j^2\right)\]</p><p>with flow restriction <span>$κ_{i,j} = \int_0^{L_{i,j}} η(T_{i,j})T_{i,j}/d_{i,j}^4 dx$</span>, pressures <span>$p_i$</span> resp. <span>$p_j$</span> at the vertices <span>$i$</span> resp. <span>$j$</span>, temperature <span>$T_{i,j}$</span>, capillary length <span>$L_{i,j}$</span> and diameter <span>$d_{i,j}$</span> of the edge <code>i =&gt; j</code>.</p><p><strong>Arguments</strong></p><ul><li><code>sys</code>: System structure of the capillary system for which the flow balance is set up.</li><li><code>p2fun</code>: Julia function of the solutions of the flow balance equations from <code>build_pressure_squared_functions(sys; mode=&quot;λ&quot;)</code></li><li><code>mode</code>: Mode for flow equations to use flow permeabilities λ (<code>mode = λ</code>; default) or flow restrictions κ (<code>mode = κ</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Flowcalc.jl#L765-L782">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.flow_permeabilities-Tuple{Any}" href="#GasChromatographySystems.flow_permeabilities-Tuple{Any}"><code>GasChromatographySystems.flow_permeabilities</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">flow_permeabilities(sys)</code></pre><p>Calculates the flow permeabilities λ of all edges (capliaries) of a system of capillaries.</p><p><strong>Arguments</strong></p><ul><li><code>sys</code>: System structure of the capillary system for which the flow balance is set up.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/GasChromatographySystems.jl#L287-L294">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.flow_restrictions-Tuple{Any}" href="#GasChromatographySystems.flow_restrictions-Tuple{Any}"><code>GasChromatographySystems.flow_restrictions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">flow_restrictions(sys)</code></pre><p>Calculates the flow restrictions κ of all edges (capliaries) of a system of capillaries.</p><p><strong>Arguments</strong></p><ul><li><code>sys</code>: System structure of the capillary system for which the flow balance is set up.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/GasChromatographySystems.jl#L269-L276">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.graph_to_parameters-NTuple{4, Any}" href="#GasChromatographySystems.graph_to_parameters-NTuple{4, Any}"><code>GasChromatographySystems.graph_to_parameters</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">graph_to_parameters(sys, p2fun, db_dataframe, selected_solutes; interp=true, dt=1, mode=&quot;λ&quot;)</code></pre><p>Convert a gas chromatography system graph into simulation parameters for each module.</p><p>This function processes a GC system graph and generates the necessary parameters for simulating solute transport through each module in the system. It handles both column modules and thermal modulators, setting up temperature programs, pressure functions, and substance parameters.</p><p><strong>Arguments</strong></p><ul><li><code>sys</code>: The GC system structure containing the network of modules</li><li><code>p2fun</code>: Pressure functions for the system</li><li><code>db_dataframe</code>: Database containing solute properties</li><li><code>selected_solutes</code>: List of solutes to include in the simulation</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>interp</code>: Whether to use interpolated pressure functions (default: true)</li><li><code>dt</code>: Time step for pressure function interpolation (default: 1)</li><li><code>mode</code>: Mode for flow calculations (&quot;λ&quot; for permeability or &quot;κ&quot; for restriction) (default: &quot;λ&quot;)</li></ul><p><strong>Returns</strong></p><ul><li>Array of <code>GasChromatographySimulator.Parameters</code> objects, one for each module in the system</li></ul><p><strong>Notes</strong></p><ul><li>Handles both constant and programmed temperature/pressure conditions</li><li>Sets up column parameters including length, diameter, and stationary phase</li><li>Configures temperature programs with interpolation functions</li><li>Loads solute properties from the database for the specified stationary phase</li><li>Applies module-specific options including numerical solver settings</li><li>Supports both ModuleColumn and ModuleTM (thermal modulator) types</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/SystemToParameters.jl#L43-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.holdup_time_functions-Tuple{Any, Any}" href="#GasChromatographySystems.holdup_time_functions-Tuple{Any, Any}"><code>GasChromatographySystems.holdup_time_functions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">holdup_time_functions(sys, p2fun; mode=&quot;λ&quot;)</code></pre><p>Collects the hold-up time functions as functions of time t for all edges of the system of capillaries <code>sys</code>.</p><p>The hold-up time over edge <code>i =&gt; j</code> is calculated as</p><p class="math-container">\[t_{M_{i,j}} = \frac{128}{3} η(T_{i,j}) \frac{L_{i,j}^2}{d_{i,j}^2} \frac{p_i^3-p_j^3}{\left(p_i^2-p_j^2\right)^2}\]</p><p>with flow restriction, pressures <span>$p_i$</span> resp. <span>$p_j$</span> at the vertices <span>$i$</span> resp. <span>$j$</span>, temperature <span>$T_{i,j}$</span>, capillary length <span>$L_{i,j}$</span> and diameter <span>$d_{i,j}$</span> of the edge <code>i =&gt; j</code>.</p><p><strong>Arguments</strong></p><ul><li><code>sys</code>: System structure of the capillary system for which the flow balance is set up.</li><li><code>p2fun</code>: Julia function of the solutions of the flow balance equations from <code>build_pressure_squared_functions(sys; mode=&quot;λ&quot;)</code></li><li><code>mode</code>: Mode for flow equations to use flow permeabilities λ (<code>mode = λ</code>; default) or flow restrictions κ (<code>mode = κ</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Flowcalc.jl#L834-L851">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.holdup_time_path-Tuple{Any, Any, Any}" href="#GasChromatographySystems.holdup_time_path-Tuple{Any, Any, Any}"><code>GasChromatographySystems.holdup_time_path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">holdup_time_path(sys, p2fun, numpaths; mode=&quot;λ&quot;)</code></pre><p>Calculates the hold-up times of the <code>numpaths</code> paths as functions of time t of the system of capillaries <code>sys</code>.</p><p>The hold-up time over edge <code>i =&gt; j</code> is calculated as</p><p><strong>Arguments</strong></p><ul><li><code>sys</code>: System structure of the capillary system for which the flow balance is set up.</li><li><code>p2fun</code>: Julia function of the solutions of the flow balance equations from <code>build_pressure_squared_functions(sys; mode=&quot;λ&quot;)</code></li><li><code>numpaths</code>: Number of the different paths between inlet and outlets of system <code>sys</code>.</li><li><code>mode</code>: Mode for flow equations to use flow permeabilities λ (<code>mode = λ</code>; default) or flow restrictions κ (<code>mode = κ</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Flowcalc.jl#L896-L908">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.interpolate_pressure_functions-Tuple{Any, Any}" href="#GasChromatographySystems.interpolate_pressure_functions-Tuple{Any, Any}"><code>GasChromatographySystems.interpolate_pressure_functions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">interpolate_pressure_functions(sys, p2fun; dt=1, mode=&quot;λ&quot;)</code></pre><p>Interpolates (linearly) all pressure funtions at the vertices of the system of capillaries <code>sys</code> between the time steps <code>dt</code>. For the speed of the simulation these interpolated functions are faster than the pure solution functions of the flow balance equations.</p><p><strong>Arguments</strong></p><ul><li><code>sys</code>: System structure of the capillary system for which the flow balance is set up.</li><li><code>p2fun</code>: Julia function of the solutions of the flow balance equations from <code>build_pressure_squared_functions(sys; mode=&quot;λ&quot;)</code></li><li><code>dt</code>: time steps, where the original pressure function is evaluated. Inbetween these time steps the pressure function is linearly interpolated. </li><li><code>mode</code>: Mode for flow equations to use flow permeabilities λ (<code>mode = λ</code>; default) or flow restrictions κ (<code>mode = κ</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Flowcalc.jl#L663-L673">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.mod_number-NTuple{4, Any}" href="#GasChromatographySystems.mod_number-NTuple{4, Any}"><code>GasChromatographySystems.mod_number</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mod_number(t, shift, PM, ratio)</code></pre><p>Calculate the modulation number for a given time point using the same timing logic as <code>therm_mod</code>.</p><p><strong>Arguments</strong></p><ul><li><code>t</code>: Time point at which to calculate the modulation number</li><li><code>shift</code>: Time shift of the modulation pattern (in seconds)</li><li><code>PM</code>: Modulation period (in seconds)</li><li><code>ratio</code>: Ratio of cold phase duration to total period (0 &lt; ratio &lt; 1)</li></ul><p><strong>Returns</strong></p><ul><li>Integer modulation number (1-based)</li></ul><p><strong>Notes</strong></p><ul><li>Uses the same timing logic as <code>therm_mod</code></li><li>Returns 1 for the first modulation period</li><li>Uses 4 digits precision to avoid rounding issues</li><li>Calculates modulation number directly from time value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/GasChromatographySystems.jl#L585-L604">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.modulator_phase-Tuple{Any, Any, Any}" href="#GasChromatographySystems.modulator_phase-Tuple{Any, Any, Any}"><code>GasChromatographySystems.modulator_phase</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">modulator_phase(tstart, t_next_hot, tcold)</code></pre><p>Determine the phase of the modulation and initial timesfor each peak based on the start time and the time of the start of the next hot jet. </p><p><strong>Arguments</strong></p><ul><li><code>tstart</code>: Start time of the peak</li><li><code>t_next_hot</code>: Time of the start of the next hot jet</li><li><code>tcold</code>: Duration of the cold jet</li></ul><p><strong>Returns</strong></p><ul><li><code>t₀</code>: initial time of the peak</li><li><code>phase</code>: Phase of the modulation (&#39;cold&#39; or &#39;hot&#39;)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/ThermalModulator.jl#L415-L428">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.module_temperature-Tuple{GasChromatographySystems.ModuleColumn, Any}" href="#GasChromatographySystems.module_temperature-Tuple{GasChromatographySystems.ModuleColumn, Any}"><code>GasChromatographySystems.module_temperature</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">module_temperature(module_::ModuleColumn, sys)</code></pre><p>Calculate temperature parameters for a column module in a gas chromatography system.</p><p>This function handles temperature calculations for a standard column module, supporting both constant temperature and temperature programs. It returns the necessary parameters for temperature interpolation along the column.</p><p><strong>Arguments</strong></p><ul><li><code>module_</code>: A ModuleColumn instance containing column parameters</li><li><code>sys</code>: The GC system structure containing the network of modules</li></ul><p><strong>Returns</strong></p><ul><li><code>time_steps</code>: Array of time points for the temperature program</li><li><code>temp_steps</code>: Array of temperature values at each time point</li><li><code>gf</code>: Gradient function for temperature program</li><li><code>a_gf</code>: Gradient coefficients</li><li><code>T_itp</code>: Temperature interpolation function that takes position and time as arguments</li></ul><p><strong>Notes</strong></p><ul><li>For constant temperature, uses system&#39;s common timesteps or default [0.0, 36000.0]</li><li>Handles NaN column length by defaulting to 1.0</li><li>Supports both constant temperature and temperature program modes</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/GasChromatographySystems.jl#L159-L183">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.module_temperature-Tuple{GasChromatographySystems.ModuleTM, Any}" href="#GasChromatographySystems.module_temperature-Tuple{GasChromatographySystems.ModuleTM, Any}"><code>GasChromatographySystems.module_temperature</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">module_temperature(module_::ModuleTM, sys)</code></pre><p>Calculate temperature parameters for a thermal modulator module in a gas chromatography system.</p><p>This function handles temperature calculations for a thermal modulator, combining a base temperature program with periodic modulation between hot and cold phases. It supports both absolute and relative temperature modes for the cold jet.</p><p><strong>Arguments</strong></p><ul><li><code>module_</code>: A ModuleTM instance containing thermal modulator parameters</li><li><code>sys</code>: The GC system structure containing the network of modules</li></ul><p><strong>Returns</strong></p><ul><li><code>time_steps</code>: Array of time points for the temperature program</li><li><code>temp_steps</code>: Array of temperature values at each time point</li><li><code>gf</code>: Gradient function for temperature program</li><li><code>a_gf</code>: Gradient coefficients</li><li><code>spot</code>: Temperature function that combines base temperature with modulation</li></ul><p><strong>Notes</strong></p><ul><li>Supports both constant temperature and temperature program modes</li><li>Cold jet temperature can be either absolute (Tcold_abs=true) or relative to base temperature</li><li>Includes spatial temperature distribution (spot function) when ng=false</li><li>Temperature values are converted between °C and K as needed</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/GasChromatographySystems.jl#L210-L235">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.pressure_functions-Tuple{Any, Any}" href="#GasChromatographySystems.pressure_functions-Tuple{Any, Any}"><code>GasChromatographySystems.pressure_functions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pressure_functions(sys, p2fun; mode=&quot;λ&quot;)</code></pre><p>Collect all pressure functions as functions of time t at the vertices of the capillary system <code>sys</code>, either from defined input values or from the solutions of the flow balance equations. </p><p><strong>Arguments</strong></p><ul><li><code>sys</code>: System structure of the capillary system for which the flow balance is set up.</li><li><code>p2fun</code>: Julia function of the solutions of the flow balance equations from <code>build_pressure_squared_functions(sys; mode=&quot;λ&quot;)</code></li><li><code>mode</code>: Mode for flow equations to use flow permeabilities λ (<code>mode = λ</code>; default) or flow restrictions κ (<code>mode = κ</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Flowcalc.jl#L604-L613">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.save_build_pressure_squared_functions-Tuple{Any, Any}" href="#GasChromatographySystems.save_build_pressure_squared_functions-Tuple{Any, Any}"><code>GasChromatographySystems.save_build_pressure_squared_functions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_build_pressure_squared_functions(sys, solution; filename=pwd()*&quot;/p2fun_&quot;*sys.name, mode=&quot;λ&quot;)</code></pre><p>Constructs and saves the array of functions of the solutions <code>solution</code> for the unkown squared pressures of the flow balance equations of the system of capillaries <code>sys</code>.</p><p><strong>Arguments</strong></p><ul><li><code>sys</code>: System structure of the capillary system for which the flow balance is set up.</li><li><code>filename</code>: Filename, where the solution functions are saved. Default <code>pwd()*&quot;/p2fun_&quot;*sys.name</code> attached with <code>&quot;_λ.jl&quot;</code> or <code>&quot;_κ.jl&quot;</code>, depending on <code>mode</code>.</li><li><code>mode</code>: Mode for flow equations to use flow permeabilities λ (<code>mode = λ</code>; default) or flow restrictions κ (<code>mode = κ</code>)</li></ul><p><strong>Output</strong></p><p>A dictionary with the folowing keys is saved in a <code>.jl</code> file:</p><ul><li><code>&quot;p2fun&quot;</code>: the build function of the solutions</li><li><code>&quot;i_known_p&quot;</code>: the indices of the known pressures.</li><li><code>&quot;i_known_λ&quot;</code>: the indices of the known flow permeabilities.</li><li><code>&quot;i_known_F&quot;</code>: the indices of the known flows.</li><li><code>&quot;mode&quot;</code>: mode of the functions using flow permeabilities λ or flow restrictions κ.</li></ul><p><strong>Loading</strong></p><p>The saved dictionary can easily be loaded into Julia by</p><pre><code class="language-Julia hljs">p2fun_load = include(&quot;p2fun_saved.jl&quot;)</code></pre><p>The build functions have to be evaluated by <code>eval.(p2fun_load[&quot;p2fun&quot;])</code> before usage. The arguments for the squared pressure functions are the ordered known squared pressures <span>$p^2$</span>, the ordered known flow permabilities <span>$λ$</span> resp. flow restrictions <span>$κ$</span>, the ordered known flows <span>$F$</span> and constant <span>$A = π/256 p_n/T_n$</span>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Flowcalc.jl#L430-L454">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.simplifiedTM-NTuple{7, Any}" href="#GasChromatographySystems.simplifiedTM-NTuple{7, Any}"><code>GasChromatographySystems.simplifiedTM</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simplifiedTM(T, par, df_A, PM, ratio, shift, Thot)</code></pre><p>Simulate thermal modulation using a simplified model that assumes rectangular temperature modulation.</p><p>This function simulates the behavior of solutes in a thermal modulator using a simplified approach that assumes instantaneous temperature changes between hot and cold phases. It calculates retention times, peak widths, and other chromatographic parameters for each modulated peak.</p><p><strong>Arguments</strong></p><ul><li><code>T</code>: Temperature program or constant temperature value</li><li><code>par</code>: Simulation parameters for the system</li><li><code>df_A</code>: DataFrame containing sliced peak information (from slicing function)</li><li><code>PM</code>: Modulation period in seconds</li><li><code>ratio</code>: Ratio of cold phase duration to total period (0 &lt; ratio &lt; 1)</li><li><code>shift</code>: Time shift of the modulation pattern in seconds</li><li><code>Thot</code>: Temperature difference for the hot phase in °C</li></ul><p><strong>Returns</strong></p><ul><li>Tuple containing:<ol><li>DataFrame with chromatographic parameters:<ul><li>No: Modulation number</li><li>Name: Substance names</li><li>CAS: CAS numbers</li><li>tR: Retention times</li><li>τR: Peak widths</li><li>TR: Temperatures at retention</li><li>σR: Peak standard deviations</li><li>uR: Linear velocities</li><li>kR: Retention factors</li><li>Res: Resolution between adjacent peaks</li><li>Δs: Separation measure</li><li>Annotations: Peak annotations</li><li>A: Peak areas</li></ul></li><li>Array of solution tuples containing:<ul><li>t: column position [0, column length]</li><li>u: Tuples of (time, variance) at start and end points</li></ul></li></ol></li></ul><p><strong>Notes</strong></p><ul><li>Assumes rectangular temperature modulation (instantaneous temperature changes)</li><li>Calculates retention times based on the start of the next hot phase with added peak width (time to flush out the peak)</li><li>Calculates peak widths from band width equal to the length of the modulator segment</li><li>using simulation results in similar values, but takes longer to calculate, see &#39;simplifiedTM<em>mod2&#39; and &#39;simplifiedTM</em>mod3&#39;</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/ThermalModulator.jl#L115-L158">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.simplifiedTM_mod2-NTuple{8, Any}" href="#GasChromatographySystems.simplifiedTM_mod2-NTuple{8, Any}"><code>GasChromatographySystems.simplifiedTM_mod2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simplifiedTM_mod2(T, par, df_A, PM, ratio, shift, Thot, Tcold)</code></pre><p>Estimate retention times and peak widths for thermal modulation by assuming isothermal conditions during cold and hot phases.</p><p>This function uses a simplified approach that treats the cold and hot phases as separate isothermal conditions. It calculates retention times by:</p><ol><li>Determining the cold phase temperature (Tmin) based on whether Tcold is absolute or relative</li><li>Creating separate temperature interpolation functions for cold and hot phases</li><li>Calculating retention factors and holdup times for both phases</li><li>Estimating the migration distance during cold phase</li><li>Computing final retention times based on hot phase conditions</li></ol><p><strong>Arguments</strong></p><ul><li><code>T</code>: Base temperature or temperature program for the column</li><li><code>par</code>: Parameters structure containing column, program, and substance information</li><li><code>df_A</code>: DataFrame containing peak areas and initial times</li><li><code>PM</code>: Modulation period in seconds</li><li><code>ratio</code>: Ratio of cold phase duration to total period (0 &lt; ratio &lt; 1)</li><li><code>shift</code>: Time shift of the modulation pattern in seconds</li><li><code>Thot</code>: Temperature difference for hot phase in °C</li><li><code>Tcold</code>: Temperature difference for cold phase in °C (absolute or relative)</li></ul><p><strong>Returns</strong></p><ul><li><code>peaklist</code>: DataFrame containing retention times and peak parameters</li><li><code>solutions</code>: Solutions from the simulation</li><li><code>T_itp_cold</code>: Temperature interpolation function for cold phase</li><li><code>T_itp_hot</code>: Temperature interpolation function for hot phase</li></ul><p><strong>Notes</strong></p><ul><li>Assumes isothermal conditions during both cold and hot phases</li><li>Uses a simplified approach that may not capture all temperature transition effects</li><li>Calculates migration distance during cold phase to estimate peak positions</li><li>Performs a final simulation using cold phase conditions to verify results</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/ThermalModulator.jl#L215-L249">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.simplifiedTM_mod3-NTuple{7, Any}" href="#GasChromatographySystems.simplifiedTM_mod3-NTuple{7, Any}"><code>GasChromatographySystems.simplifiedTM_mod3</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simplifiedTM_mod3(T, par, df_A, PM, ratio, shift, Thot)</code></pre><p>Estimate retention times and peak widths for thermal modulation by simulating from the hot phase start.</p><p>This function uses a more detailed approach that:</p><ol><li>Determines whether peaks arrive during cold or hot phase</li><li>Adjusts initial conditions based on arrival phase</li><li>Uses a simplified temperature profile using hot phase conditions</li><li>Performs a full simulation to calculate retention times and peak widths</li></ol><p><strong>Arguments</strong></p><ul><li><code>T</code>: Base temperature or temperature program for the column</li><li><code>par</code>: Parameters structure containing column, program, and substance information</li><li><code>df_A</code>: DataFrame containing peak areas and initial times from slicing</li><li><code>PM</code>: Modulation period in seconds</li><li><code>ratio</code>: Ratio of cold phase duration to total period (0 &lt; ratio &lt; 1)</li><li><code>shift</code>: Time shift of the modulation pattern in seconds</li><li><code>Thot</code>: Temperature difference for hot phase in °C</li></ul><p><strong>Returns</strong></p><ul><li><code>peaklist</code>: DataFrame containing retention times and peak parameters</li><li><code>solutions</code>: Solutions from the simulation</li></ul><p><strong>Notes</strong></p><ul><li>Assumes rectangular temperature modulation pattern</li><li>Adjusts initial conditions based on whether peaks arrive during cold or hot phase</li><li>Uses a simplified temperature profile to avoid ODE solver issues</li><li>Provides more accurate results than simplifiedTM_mod2 but takes longer to compute</li><li>Issues warnings for peaks that arrive during hot phase</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/ThermalModulator.jl#L323-L353">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.simulate_ModuleColumn-Tuple{Any, Any, Any}" href="#GasChromatographySystems.simulate_ModuleColumn-Tuple{Any, Any, Any}"><code>GasChromatographySystems.simulate_ModuleColumn</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_ModuleColumn(segment_par, t₀, τ₀)
simulate_ModuleColumn(segment_par, prev_peaklist)</code></pre><p>Simulate solute transport through a column module in a gas chromatography system.</p><p>This function simulates the behavior of solutes in a column module, either starting from initial conditions or continuing from a previous module&#39;s results. It calculates retention times, peak widths, and other chromatographic parameters.</p><p><strong>Arguments</strong></p><ul><li><code>segment_par</code>: Simulation parameters for the column module</li><li><code>t₀</code>: Initial time points (first variant)</li><li><code>τ₀</code>: Initial peak widths (first variant)</li><li><code>prev_peaklist</code>: Peak list from previous module (second variant)</li></ul><p><strong>Returns</strong></p><ul><li>Tuple containing:<ol><li>Updated simulation parameters</li><li>Peak list with chromatographic parameters</li><li>Solution trajectories</li></ol></li></ul><p><strong>Notes</strong></p><ul><li>First variant is used for the initial column segment</li><li>Second variant is used for subsequent column segments</li><li>Peak areas are preserved between segments</li><li>Initial areas are set to 1.0 for the first segment</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/SolvingSystems.jl#L111-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.simulate_ModuleTM-Tuple{Any, Any, Any}" href="#GasChromatographySystems.simulate_ModuleTM-Tuple{Any, Any, Any}"><code>GasChromatographySystems.simulate_ModuleTM</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_ModuleTM(segment_par, segment_module, prev_peaklist; nτ=6, τ₀_focus=zeros(length(segment_par.sub)), refocus=false, kwargsTM...)</code></pre><p>Simulate solute transport through a thermal modulator module in a gas chromatography system.</p><p>This function simulates the behavior of solutes in a thermal modulator, handling both simplified and full simulation approaches. It includes peak slicing, temperature modulation, and optional refocusing of peaks.</p><p><strong>Arguments</strong></p><ul><li><code>segment_par</code>: Simulation parameters for the thermal modulator</li><li><code>segment_module</code>: Thermal modulator module configuration</li><li><code>prev_peaklist</code>: Peak list from previous module</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>nτ</code>: Number of peak widths to consider for slicing (default: 6)</li><li><code>τ₀_focus</code>: Initial peak widths for refocusing (default: zeros)</li><li><code>refocus</code>: Whether to refocus peaks (default: false)</li><li><code>kwargsTM</code>: Additional keyword arguments for simulation</li></ul><p><strong>Returns</strong></p><ul><li>Tuple containing:<ol><li>Updated simulation parameters</li><li>Peak list with chromatographic parameters</li><li>Solution trajectories</li></ol></li></ul><p><strong>Notes</strong></p><ul><li>Supports two simulation algorithms:<ul><li>&quot;simplifiedTM&quot;: Uses simplified rectangular temperature modulation</li><li>Full simulation: Uses ODE solving with adaptive time steps (this only works if the segment has a stationary phase)</li></ul></li><li>Performs peak slicing based on modulation periods</li><li>Checks for peak widths exceeding modulation period</li><li>Handles temperature programs and constant temperatures</li><li>Preserves peak areas through the modulation process</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/ThermalModulator.jl#L515-L549">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.simulate_along_paths-NTuple{4, Any}" href="#GasChromatographySystems.simulate_along_paths-NTuple{4, Any}"><code>GasChromatographySystems.simulate_along_paths</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_along_paths(sys, p2fun, paths, par_sys; t₀=zeros(length(par_sys[1].sub)), τ₀=zeros(length(par_sys[1].sub)), nτ=6, refocus=falses(ne(sys.g)), τ₀_focus=zeros(length(par_sys[1].sub)), mode=&quot;λ&quot;, kwargsTM...)</code></pre><p>Simulate solute transport along multiple paths in a gas chromatography system.</p><p>This function simulates the transport of solutes through a network of GC modules (columns and thermal modulators) along specified paths. It handles both direct simulation of new segments and reuse of previously simulated segments when possible.</p><p><strong>Arguments</strong></p><ul><li><code>sys</code>: The GC system structure containing the network of modules</li><li><code>p2fun</code>: Pressure functions for the system</li><li><code>paths</code>: Array of paths to simulate, where each path is a sequence of edges in the system graph</li><li><code>par_sys</code>: Array of parameter sets for each module in the system</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>t₀</code>: Initial times for solutes (default: zeros)</li><li><code>τ₀</code>: Initial peak widths for solutes (default: zeros)</li><li><code>nτ</code>: Number of peak widths to consider for slicing in the thermal modulator (default: 6)</li><li><code>refocus</code>: Boolean array indicating which modules should refocus peaks (default: all false)</li><li><code>τ₀_focus</code>: Initial peak widths for refocusing (default: zeros)</li><li><code>mode</code>: Mode for flow calculations (&quot;λ&quot; for permeability or &quot;κ&quot; for restriction) (default: &quot;λ&quot;)</li><li><code>kwargsTM</code>: Additional keyword arguments for thermal modulator simulation</li></ul><p><strong>Returns</strong></p><ul><li><code>path_pos</code>: Array of strings indicating if each path is possible and any issues encountered</li><li><code>peaklists</code>: Array of peak lists for each path, containing retention times and peak widths</li><li><code>solutions</code>: Array of solutions for each path, containing detailed simulation results</li><li><code>new_par_sys</code>: Updated parameter sets for the system</li></ul><p><strong>Notes</strong></p><ul><li>Reuses simulation results from previous paths when possible to improve efficiency</li><li>Handles both ModuleColumn and ModuleTM (thermal modulator) types</li><li>Checks for negative flows to determine if paths are possible</li><li>First segment after injection is assumed to be a ModuleColumn</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/SolvingSystems.jl#L159-L194">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.slicing-Tuple{Any, Any, Any, Any, GasChromatographySimulator.Parameters}" href="#GasChromatographySystems.slicing-Tuple{Any, Any, Any, Any, GasChromatographySimulator.Parameters}"><code>GasChromatographySystems.slicing</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">slicing(pl, PM, ratio, shift, par; nτ=6, τ₀=zeros(length(pl.τR)), abstol=1e-8, reltol=1e-8, alg=OwrenZen5())</code></pre><p>Slice peaks into segments based on thermal modulation periods and calculate their areas.</p><p>This function handles the slicing of chromatographic peaks into segments that align with thermal modulation periods. It calculates the areas of these segments and creates new substance parameters for each slice. The function is designed to work with both single-stage and multi-stage modulation systems.</p><p><strong>Arguments</strong></p><ul><li><code>pl</code>: Peak list containing retention times, peak widths, and areas</li><li><code>PM</code>: Modulation period in seconds</li><li><code>ratio</code>: Ratio of cold phase duration to total period (0 &lt; ratio &lt; 1)</li><li><code>shift</code>: Time shift of the modulation pattern in seconds</li><li><code>par</code>: Original simulation parameters</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>nτ</code>: Number of peak widths to consider for slicing (default: 6)</li><li><code>τ₀</code>: Initial peak widths for new slices (default: zeros)</li><li><code>abstol</code>: Absolute tolerance for numerical integration (default: 1e-8)</li><li><code>reltol</code>: Relative tolerance for numerical integration (default: 1e-8)</li><li><code>alg</code>: Numerical integration algorithm (default: OwrenZen5())</li></ul><p><strong>Returns</strong></p><ul><li><code>newpar_focussed</code>: New parameters object containing the sliced substances</li><li><code>df_A_foc</code>: DataFrame containing:<ul><li>Name: Substance names</li><li>CAS: CAS numbers</li><li>Annotations: Slice annotations (e.g., &quot;s1<em>&quot;, &quot;s2</em>&quot;, etc.)</li><li>A: Calculated areas for each slice</li><li>t0: Start times of each slice</li></ul></li></ul><p><strong>Notes</strong></p><ul><li>Uses mod_number for consistent modulation period calculations</li><li>Handles peaks that span multiple modulation periods</li><li>Calculates areas using Gaussian peak approximation</li><li>For peaks within a single modulation period, uses the original area</li><li>For multi-period peaks, integrates the Gaussian function over each period</li><li>Appoximation: integration over the whole period, in reality the segment of the peak during the hot-jet is not included. Assuming a second focussing the not focussed segment should be focussed there.</li><li>Maintains substance properties while creating new slice annotations</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/ThermalModulator.jl#L8-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.solve_balance-Tuple{Any}" href="#GasChromatographySystems.solve_balance-Tuple{Any}"><code>GasChromatographySystems.solve_balance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">solve_balance(sys; mode=&quot;λ&quot;, bal_eq = flow_balance(sys))</code></pre><p>Solves the substituted flow balance equations of the capillary system <code>sys</code> for the squared pressures of vertices with undefined pressures as an array of symbolic expressions.</p><p><strong>Arguments</strong></p><ul><li><code>sys</code>: System structure of the capillary system for which the flow balance is set up.</li><li><code>mode</code>: Mode for flow equations to use flow permeabilities λ (<code>mode = λ</code>; default) or flow restrictions κ (<code>mode = κ</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Flowcalc.jl#L216-L224">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.substitute_pressure_squared_functions-Tuple{Any, Any}" href="#GasChromatographySystems.substitute_pressure_squared_functions-Tuple{Any, Any}"><code>GasChromatographySystems.substitute_pressure_squared_functions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">substitute_pressure_squared_functions(p2fun, sys; mode=&quot;λ&quot;)</code></pre><p>Substitutes the the pressure functions (solutions to the flow balance equations) with the known quantities of pressures, flows, flow restictions/permabilities.</p><p>This results in an array of pressures <span>$p$</span> at vertices without defined pressure as function of time <span>$t$</span>. </p><p><strong>Arguments</strong></p><ul><li><code>p2fun</code>: Julia function of the solutions of the flow balance equations from <code>build_pressure_squared_functions(sys; mode=&quot;λ&quot;)</code></li><li><code>sys</code>: System structure of the capillary system for which the flow balance is set up.</li><li><code>mode</code>: Mode for flow equations to use flow permeabilities λ (<code>mode = λ</code>; default) or flow restrictions κ (<code>mode = κ</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Flowcalc.jl#L524-L535">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.substitute_unknown_flows-Tuple{Any}" href="#GasChromatographySystems.substitute_unknown_flows-Tuple{Any}"><code>GasChromatographySystems.substitute_unknown_flows</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">substitute_unknown_flows(sys; mode=&quot;λ&quot;, bal_eq = flow_balance(sys))</code></pre><p>Substitutes flow equations for undefined flows over edges in the capillary system <code>sys</code> in the flow balance equation system. </p><p>Flow equation over edge <span>$j,i$</span> between vertice <code>ì</code><code>and</code><code>j</code><code>with flow permability</code><code>λ_{i,j}</code>`:</p><p class="math-container">\[F_{i,j} = A λ_{i,j} \left(p_i^2-p_j^2\right)\]</p><p>For flow resistance <span>$κ_{i,j}$</span>:</p><p class="math-container">\[F_{i,j} = \frac{A}{κ_{i,j}} \left(p_i^2-p_j^2\right)\]</p><p><strong>Arguments</strong></p><ul><li><code>sys</code>: System structure of the capillary system for which the flow balance is set up.</li><li><code>mode</code>: Mode for flow equations to use flow permeabilities λ (<code>mode = λ</code>; default) or flow restrictions κ (<code>mode = κ</code>)</li><li><code>bal_eq</code>: Array of the symbolic flow balance equations; defaults to <code>flow_balance(sys)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Flowcalc.jl#L49-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.therm_mod-NTuple{6, Any}" href="#GasChromatographySystems.therm_mod-NTuple{6, Any}"><code>GasChromatographySystems.therm_mod</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">therm_mod(t, shift, PM, ratio, Tcold, Thot; flank=20)</code></pre><p>Generate a periodic temperature modulation pattern for thermal modulation in gas chromatography.</p><p>The function creates a temperature profile that alternates between cold (Tcold) and hot (Thot) phases with a specified period (PM). The pattern can be either a sharp rectangular function or a smoothed version with controlled transition flanks.</p><p><strong>Arguments</strong></p><ul><li><code>t</code>: Time point(s) at which to evaluate the temperature</li><li><code>shift</code>: Time shift of the modulation pattern (in seconds)</li><li><code>PM</code>: Modulation period (in seconds)</li><li><code>ratio</code>: Ratio of cold phase duration to total period (0 &lt; ratio &lt; 1)</li><li><code>Tcold</code>: Temperature during the cold phase (in °C)</li><li><code>Thot</code>: Temperature during the hot phase (in °C)</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>flank</code>: Controls the smoothness of temperature transitions. Use <code>Inf</code> for sharp transitions,         or a positive number for smoothed transitions (default: 20)</li></ul><p><strong>Returns</strong></p><ul><li>Temperature value(s) at the specified time point(s)</li></ul><p><strong>Notes</strong></p><ul><li>on modulation consists of a cold phase and a hot phase in this order</li><li>The cold phase duration is <code>ratio * PM</code></li><li>The hot phase duration is <code>(1 - ratio) * PM</code></li><li>When <code>shift = 0</code>, the pattern starts with the hot phase</li><li>The <code>flank</code> parameter controls the width of the temperature transition regions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/GasChromatographySystems.jl#L525-L555">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.unknown_F-Tuple{Any}" href="#GasChromatographySystems.unknown_F-Tuple{Any}"><code>GasChromatographySystems.unknown_F</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>unknown_F(sys)</p><p>Extract the index of the edges of the graph of system <code>sys</code> for which the flows <code>F</code> are not defined. </p><p><strong>Arguments</strong></p><ul><li><code>sys</code>: System structure of the capillary system for which the flow balance is set up.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Flowcalc.jl#L156-L163">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.unknown_p-Tuple{Any}" href="#GasChromatographySystems.unknown_p-Tuple{Any}"><code>GasChromatographySystems.unknown_p</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>unknown_p(sys)</p><p>Extract the index of the vertices of the graph of system <code>sys</code> for which the pressure <code>p</code> are not defined. </p><p><strong>Arguments</strong></p><ul><li><code>sys</code>: System structure of the capillary system for which the flow balance is set up.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Flowcalc.jl#L174-L181">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GasChromatographySystems.unknown_λ-Tuple{Any}" href="#GasChromatographySystems.unknown_λ-Tuple{Any}"><code>GasChromatographySystems.unknown_λ</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>unknown_λ(sys)</p><p>Extract the index of the edges of the graph of system <code>sys</code> for which the flow permeabilities <code>λ</code> are not defined. </p><p><strong>Arguments</strong></p><ul><li><code>sys</code>: System structure of the capillary system for which the flow balance is set up.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/GasChromatographySystems.jl/blob/b2029ec25f8efd7a541648de26161791accd5238/src/Flowcalc.jl#L198-L205">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/">« Examples</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Tuesday 27 May 2025 12:13">Tuesday 27 May 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
